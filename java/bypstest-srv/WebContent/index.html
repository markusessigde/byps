<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>JavaScript API</title>

<script type="text/javascript" src="json2.js">
</script>

<script type="text/javascript" src="byps.js">
</script>

<script type="text/javascript" src="testser.js">
</script>

<script type="text/javascript">


var url = "/bypstest-srv/bypsservlet";
var client = byps.test.api.createClient_Testser(url);

function test() {

	var arr = [];
	var b = Array.isArray(arr);
	
	var bout = client.transport.getOutput();
	
	var root = {
			_typeId : 111, 
			alpha:1, 
			beta:2, 
			gamma:{
				_typeId: 222,
				a:11,
				b:12
			}
	};
	
	var msg = bout.store(root);
	
	var bin = client.transport.getInput(msg.jsonText);
	
	var root2 = bin.load();
	
}

function test5() {
	var str = "{\"header\":{\"error\":0,\"flags\":2,\"targetId\":\"904192070.7185432640225694294.114997365848280045\",\"messageId\":\"79743999126367260.\"},\"objectTable\":[null,{\"_typeId\":526443365,\"result\":{\"*i\":-2}},{\"_typeId\":1301335819,\"changedMembers\":\"0.\",\"breakTimeout\":false,\"breakTotalCount\":false,\"count\":0,\"moreResults\":false,\"searchId\":\"(52DB5BF3-3C2E-CB62-6699-57CA04DEBBE0)\",\"estimatedCount\":0,\"dynamicFolder\":\"!=JSON10{\\"findOptions\\":{\\"escapeChar\\":\\"\\",\\"orderBy\\":\\"\\",\\"sortOrder\\":0,\\"TStamp\\":\\"\\",\\"onlyDeleted\\":false,\\"searchId\\":\\"\\",\\"reserved\\":\\"0\\",\\"excludeSummary\\":false,\\"timeoutSeconds\\":0,\\"inclDeleted\\":false,\\"totalCount\\":0,\\"evalCount\\":false,\\"rangeDelimiter\\":\\"...\\",\\"searchLifetimeSeconds\\":0,\\"lockZ\\":{\\"_bs\\":[0,0,0,0],\\"clazz\\":\\"de.elo.ix.client.LockZ\\"},\\"clazz\\":\\"de.elo.ix.client.FindOptions\\",\\"searchMode\\":{\\"_bs\\":[0,0,0,0],\\"clazz\\":\\"de.elo.ix.client.SearchModeZ\\"}},\\"findChildren\\":{\\"parentId\\":\\"88\\",\\"endLevel\\":0,\\"mainParent\\":false,\\"clazz\\":\\"de.elo.ix.client.FindChildren\\"},\\"clazz\\":\\"de.elo.ix.client.FindInfo\\"}\",\"sords\":{\"*i\":-3}},[{\"*i\":-4},{\"*i\":-5},{\"*i\":-6},{\"*i\":-7},{\"*i\":-8},{\"*i\":-9},{\"*i\":-10}],{\"_typeId\":1576327931,\"changedMembers\":\"9898286907391.\",\"IDateIso\":\"20140514084600\",\"SReg\":\"\",\"TStamp\":\"2014.05.14.06.46.11\",\"XDateIso\":\"\",\"access\":23,\"acl\":\"75PYJA\",\"att\":0,\"childCount\":1,\"delDateIso\":\"\",\"deleted\":false,\"desc\":\"\",\"doc\":0,\"guid\":\"(CEFCA125-944B-C5E5-584A-A22E6D545C80)\",\"hiddenText\":\"\",\"histCount\":0,\"id\":631,\"info\":0,\"key\":0,\"kind\":0,\"lockId\":-1,\"lockName\":\"\",\"mask\":1,\"name\":\"\\\",\"ownerId\":5,\"ownerName\":\"KochC\",\"parentId\":88,\"path\":0,\"type\":2,\"vtRep\":0,\"maskName\":\"Ordner\",\"deleteDateIso\":\"\",\"aclItems\":{\"*i\":-11},\"details\":{\"*i\":-12},\"objKeys\":{\"*i\":-13}},{\"_typeId\":1576327931,\"changedMembers\":\"9898286907391.\",\"IDateIso\":\"20140512162400\",\"SReg\":\"\",\"TStamp\":\"2014.05.12.14.24.04\",\"XDateIso\":\"\",\"access\":23,\"acl\":\"75PYJA\",\"att\":0,\"childCount\":2,\"delDateIso\":\"\",\"deleted\":false,\"desc\":\"\",\"doc\":0,\"guid\":\"(422FC849-BA90-8B7A-3D2E-540FAA2E9F56)\",\"hiddenText\":\"\",\"histCount\":0,\"id\":619,\"info\":0,\"key\":0,\"kind\":0,\"lockId\":-1,\"lockName\":\"\",\"mask\":1,\"name\":\"F\",\"ownerId\":4,\"ownerName\":\"adm_KochC\",\"parentId\":88,\"path\":0,\"type\":2,\"vtRep\":0,\"maskName\":\"Ordner\",\"deleteDateIso\":\"\",\"aclItems\":{\"*i\":-14},\"details\":{\"*i\":-15},\"objKeys\":{\"*i\":-16}},{\"_typeId\":1576327931,\"changedMembers\":\"9898286907391.\",\"IDateIso\":\"20140512162900\",\"SReg\":\"\",\"TStamp\":\"2014.05.12.14.29.03\",\"XDateIso\":\"\",\"access\":23,\"acl\":\"75PYJA\",\"att\":0,\"childCount\":1,\"delDateIso\":\"\",\"deleted\":false,\"desc\":\"\",\"doc\":0,\"guid\":\"(356BA026-BBEF-AF08-7C1E-5A741015DEAE)\",\"hiddenText\":\"\",\"histCount\":0,\"id\":625,\"info\":0,\"key\":0,\"kind\":0,\"lockId\":-1,\"lockName\":\"\",\"mask\":1,\"name\":\"J\",\"ownerId\":4,\"ownerName\":\"adm_KochC\",\"parentId\":88,\"path\":0,\"type\":2,\"vtRep\":0,\"maskName\":\"Ordner\",\"deleteDateIso\":\"\",\"aclItems\":{\"*i\":-17},\"details\":{\"*i\":-18},\"objKeys\":{\"*i\":-19}},{\"_typeId\":1576327931,\"changedMembers\":\"9898286907391.\",\"IDateIso\":\"20140512162400\",\"SReg\":\"\",\"TStamp\":\"2014.05.12.14.24.04\",\"XDateIso\":\"\",\"access\":23,\"acl\":\"75PYJA\",\"att\":0,\"childCount\":1,\"delDateIso\":\"\",\"deleted\":false,\"desc\":\"\",\"doc\":0,\"guid\":\"(CAE3ADE8-B3AD-51A1-69B8-55C689F975A7)\",\"hiddenText\":\"\",\"histCount\":0,\"id\":622,\"info\":0,\"key\":0,\"kind\":0,\"lockId\":-1,\"lockName\":\"\",\"mask\":1,\"name\":\"Ref1\u001\",\"ownerId\":4,\"ownerName\":\"adm_KochC\",\"parentId\":88,\"path\":0,\"type\":2,\"vtRep\":0,\"maskName\":\"Ordner\",\"deleteDateIso\":\"\",\"aclItems\":{\"*i\":-20},\"details\":{\"*i\":-21},\"objKeys\":{\"*i\":-22}},{\"_typeId\":1576327931,\"changedMembers\":\"9898286907391.\",\"IDateIso\":\"20140512162900\",\"SReg\":\"\",\"TStamp\":\"2014.05.12.14.29.03\",\"XDateIso\":\"\",\"access\":23,\"acl\":\"75PYJA\",\"att\":0,\"childCount\":1,\"delDateIso\":\"\",\"deleted\":false,\"desc\":\"\",\"doc\":0,\"guid\":\"(51D351FB-CF52-73AF-062A-18B03F0335F9)\",\"hiddenText\":\"\",\"histCount\":0,\"id\":628,\"info\":0,\"key\":0,\"kind\":0,\"lockId\":-1,\"lockName\":\"\",\"mask\":1,\"name\":\"Ref1\u001\",\"ownerId\":4,\"ownerName\":\"adm_KochC\",\"parentId\":88,\"path\":0,\"type\":2,\"vtRep\":0,\"maskName\":\"Ordner\",\"deleteDateIso\":\"\",\"aclItems\":{\"*i\":-23},\"details\":{\"*i\":-24},\"objKeys\":{\"*i\":-25}},{\"_typeId\":1576327931,\"changedMembers\":\"9898286907391.\",\"IDateIso\":\"20140514084600\",\"SReg\":\"\",\"TStamp\":\"2014.05.14.06.46.11\",\"XDateIso\":\"\",\"access\":23,\"acl\":\"75PYJA\",\"att\":0,\"childCount\":1,\"delDateIso\":\"\",\"deleted\":false,\"desc\":\"\",\"doc\":0,\"guid\":\"(F110DBAE-ED7B-0CE1-7CB9-7FF2832F356E)\",\"hiddenText\":\"\",\"histCount\":0,\"id\":634,\"info\":0,\"key\":0,\"kind\":0,\"lockId\":-1,\"lockName\":\"\",\"mask\":1,\"name\":\"Ref1\u001\",\"ownerId\":5,\"ownerName\":\"KochC\",\"parentId\":88,\"path\":0,\"type\":2,\"vtRep\":0,\"maskName\":\"Ordner\",\"deleteDateIso\":\"\",\"aclItems\":{\"*i\":-26},\"details\":{\"*i\":-27},\"objKeys\":{\"*i\":-28}},{\"_typeId\":1576327931,\"changedMembers\":\"27490472951807.\",\"IDateIso\":\"20140520173800\",\"SReg\":\"\",\"TStamp\":\"2014.05.20.16.01.15\",\"XDateIso\":\"20140519000000\",\"access\":15,\"acl\":\"75PYJA\",\"att\":0,\"childCount\":0,\"delDateIso\":\"\",\"deleted\":false,\"desc\":\"\",\"doc\":175,\"guid\":\"(58293968-D81E-468F-A3E6-5DFD05CEF063)\",\"hiddenText\":\"\",\"histCount\":3,\"id\":648,\"info\":0,\"key\":0,\"kind\":0,\"lockId\":-1,\"lockName\":\"\",\"mask\":0,\"name\":\"EloPdfPrint_20140519163611718\",\"ownerId\":0,\"ownerName\":\"Administrator\",\"parentId\":88,\"path\":1,\"type\":259,\"vtRep\":0,\"maskName\":\"Freie Eingabe\",\"deleteDateIso\":\"\",\"aclItems\":{\"*i\":-29},\"details\":{\"*i\":-30},\"docVersion\":{\"*i\":-31},\"objKeys\":{\"*i\":-32}},[{\"*i\":-33}],{\"_typeId\":1713693326,\"changedMembers\":\"0.\",\"arcReplEnabled\":false,\"archivingMode\":2999,\"encryptionSet\":0,\"fulltext\":false,\"fulltextDone\":false,\"replRoot\":false,\"sortOrder\":1001,\"linked\":false,\"incomplete\":false,\"limitedReleaseDocument\":false},[],[{\"*i\":-34}],{\"_typeId\":1713693326,\"changedMembers\":\"0.\",\"arcReplEnabled\":false,\"archivingMode\":2999,\"encryptionSet\":0,\"fulltext\":false,\"fulltextDone\":false,\"replRoot\":false,\"sortOrder\":1001,\"linked\":false,\"incomplete\":false,\"limitedReleaseDocument\":false},[],[{\"*i\":-35}],{\"_typeId\":1713693326,\"changedMembers\":\"0.\",\"arcReplEnabled\":false,\"archivingMode\":2999,\"encryptionSet\":0,\"fulltext\":false,\"fulltextDone\":false,\"replRoot\":false,\"sortOrder\":1001,\"linked\":false,\"incomplete\":false,\"limitedReleaseDocument\":false},[],[{\"*i\":-36}],{\"_typeId\":1713693326,\"changedMembers\":\"0.\",\"arcReplEnabled\":false,\"archivingMode\":2999,\"encryptionSet\":0,\"fulltext\":false,\"fulltextDone\":false,\"replRoot\":false,\"sortOrder\":1001,\"linked\":false,\"incomplete\":false,\"limitedReleaseDocument\":false},[],[{\"*i\":-37}],{\"_typeId\":1713693326,\"changedMembers\":\"0.\",\"arcReplEnabled\":false,\"archivingMode\":2999,\"encryptionSet\":0,\"fulltext\":false,\"fulltextDone\":false,\"replRoot\":false,\"sortOrder\":1001,\"linked\":false,\"incomplete\":false,\"limitedReleaseDocument\":false},[],[{\"*i\":-38}],{\"_typeId\":1713693326,\"changedMembers\":\"0.\",\"arcReplEnabled\":false,\"archivingMode\":2999,\"encryptionSet\":0,\"fulltext\":false,\"fulltextDone\":false,\"replRoot\":false,\"sortOrder\":1001,\"linked\":false,\"incomplete\":false,\"limitedReleaseDocument\":false},[],[{\"*i\":-39}],{\"_typeId\":1713693326,\"changedMembers\":\"0.\",\"arcReplEnabled\":false,\"archivingMode\":2001,\"encryptionSet\":0,\"fulltext\":false,\"fulltextDone\":false,\"replRoot\":false,\"sortOrder\":1999,\"linked\":false,\"incomplete\":false,\"limitedReleaseDocument\":false},{\"_typeId\":633004623,\"changedMembers\":\"0.\",\"accessDateIso\":\"20140520180115\",\"comment\":\"Automatische Dokumentenkonvertierung\",\"createDateIso\":\"20140520180100\",\"deleted\":false,\"encryptionSet\":0,\"ext\":\"TIF\",\"guid\":\"(73ABCA1B-A628-4B64-871F-F37119F81620)\",\"id\":175,\"md5\":\"88FB4C8014F81938E760D5367B3C499E\",\"milestone\":false,\"ownerId\":0,\"ownerName\":\"Administrator\",\"pathId\":1,\"pathId2\":0,\"physPath\":\"C:\\ELOprofessional\\archive\\ExpeccoELO9\\basis\\UPR00000\\000000AF.TIF\",\"previewUrl\":\"\",\"size\":\"2980315.\",\"tStamp\":\"2014.05.20.16.01.15\",\"updateDateIso\":\"20140520180115\",\"uploadResult\":\"\",\"url\":\"/ix-ExpeccoELO9/ix/EloPdfPrint_20140519163611718.TIF?cmd=readdoc1&id=175&objid=648&userid=0&ticket=D94725975DE510F9125503400216455B&ext=YYYY540049004600&mode=read&valid=20140520180936&transaction=-1414850424&eticket=RDc5NEExNjM2NUMxNUMyMjY5QTAwNDFDRTFERTIyMEQ8MTQwMDYwODc3NjkxNj5B\",\"version\":\"\",\"workVersion\":true,\"contentType\":\"image/tiff\",\"deleteDateIso\":\"\",\"fulltextContent\":{\"*i\":-40}},[],{\"_typeId\":1255072841,\"changedMembers\":\"0.\",\"access\":31,\"id\":9999,\"name\":\"Jeder\",\"type\":0},{\"_typeId\":1255072841,\"changedMembers\":\"0.\",\"access\":31,\"id\":9999,\"name\":\"Jeder\",\"type\":0},{\"_typeId\":1255072841,\"changedMembers\":\"0.\",\"access\":31,\"id\":9999,\"name\":\"Jeder\",\"type\":0},{\"_typeId\":1255072841,\"changedMembers\":\"0.\",\"access\":31,\"id\":9999,\"name\":\"Jeder\",\"type\":0},{\"_typeId\":1255072841,\"changedMembers\":\"0.\",\"access\":31,\"id\":9999,\"name\":\"Jeder\",\"type\":0},{\"_typeId\":1255072841,\"changedMembers\":\"0.\",\"access\":31,\"id\":9999,\"name\":\"Jeder\",\"type\":0},{\"_typeId\":1255072841,\"changedMembers\":\"0.\",\"access\":31,\"id\":9999,\"name\":\"Jeder\",\"type\":0},{\"_typeId\":633004623,\"changedMembers\":\"0.\",\"accessDateIso\":\"\",\"comment\":\"\",\"createDateIso\":\"\",\"deleted\":false,\"encryptionSet\":0,\"ext\":\"txt\",\"guid\":\"\",\"id\":0,\"md5\":\"\",\"milestone\":false,\"ownerId\":0,\"ownerName\":\"\",\"pathId\":0,\"pathId2\":0,\"physPath\":\"\",\"previewUrl\":\"\",\"size\":\"0.\",\"tStamp\":\"\",\"updateDateIso\":\"\",\"uploadResult\":\"\",\"url\":\"/ix-ExpeccoELO9/ix/EloPdfPrint_20140519163611718_0_fulltextcontent.txt?cmd=readdoc1&id=175&objid=648&userid=0&ticket=DBA1F866D23C40E7CBFE0965AA6E36A8&ext=YYYY740078007400&mode=ft&valid=20140520180936&transaction=-481011779&eticket=RDc5NEExNjM2NUMxNUMyMjY5QTAwNDFDRTFERTIyMEQ8MTQwMDYwODc3NjkxNj5B\",\"version\":\"\",\"workVersion\":false,\"contentType\":\"plain/text\",\"deleteDateIso\":\"\"}]}";
	var obj =  JSON.parse(str);
}
test5();

function test4() {
	var inputStream = client.remoteStreams.getTextStream();
	window.location.href = inputStream.url;
};

function onResult() {
	var iFrame =  document.getElementById('uploadResultFrame');
   var iFrameBody;
   if ( iFrame.contentDocument ) 
   { // FF
     iFrameBody = iFrame.contentDocument.getElementsByTagName('body')[0];
   }
   else if ( iFrame.contentWindow ) 
   { // IE
     iFrameBody = iFrame.contentWindow.document.getElementsByTagName('body')[0];
   }
   var ret = iFrameBody.innerHTML;
   if (ret) {
	   
	   var streamIds = JSON.parse(ret);
   
	   var stream = new byps.BContentStream(streamIds[0]);
	   client.remoteStreams.setImage(stream);
	   
		var inputStream = client.remoteStreams.getImage();
		window.open(inputStream.url, "stream" + inputStream.streamId);
   }
   
   return ret;
}

function test3() {
	
	var obj = new byps.test.api.prim.PrimitiveTypes();
	obj.boolVal = true;
	obj.temp = "tempvalue";
	
	client.remotePrimitiveTypes.setObject(obj);
	
	var obj2 = client.remotePrimitiveTypes.getObject();
	
	
	try {
		var targetId = client.transport.targetId;
		var myId = document.getElementById("myId").value;
		var otherId = document.getElementById("otherId").value;
		
		client.serverIF.registerWithClientMap(myId);
		
		var otherIF = client.serverIF.getClient(otherId);
		var otherTargetId = otherIF.transport.targetId;
		
		// Invoke interface of second client.
		var r = otherIF.incrementInt(7);
		
		alert(r);
	}
	catch (e) {
		alert(e);
	}
	
	
};


function test2() {
	
	
	var obj = new byps.test.api.enu.UsePlanets();
	var jstext = JSON.stringify(obj);
	
	try {
		client.remotePrimitiveTypes.setBool(true);
		
/* 		var val = client.remotePrimitiveTypes.getBool({
			setAsyncResult : function(ret) {
				alert(ret);
			},
			setException : function(ex) {
				alert(ex);
			}
		});
 */
		
		var asyncResult = {
				setAsyncResult : function(ret) {
					alert("incr=" + ret);
				},
				setException : function(ex) {
					alert("Error:" + ex);
				}
		}
		
		var val = client.serverIF.callClientIncrementInt(4, asyncResult);
		
		
	} catch (ex) {
		alert(ex);
	}
	
};

function test1() {
	var targetId = new byps.BTargetId();
	var code = byps.BException.CORRUPT;
	
	var hdr = new byps.BNegotiate();
	var str = JSON.stringify(["N","S",0,"_",""]);
	var str2 = hdr.toJSON();
	alert(str + " -- " + str2);
	
	var arr = JSON.parse(str);
	var v = arr[4];
	
	var hdr2 = new byps.BNegotiate();
	hdr2.parse(str);
	alert(hdr2);
};

</script>

</head>
<body>
Meine ID = <input value="1" id="myId"/>
Andere ID = <input value="2" id="otherId"/>
<input type="button" value="test" onclick="test3()"/>

<form id="uploadFormId" method="post" action="/bypstest-srv/bypsservlet?uploadId=1"
      enctype="multipart/form-data" target="uploadResultFrame">
	<table>
		<tr><td><input name="uploadElement1" type="file"></td></tr>
		<tr><td><input name="uploadElement2" type="file"></td></tr>
		<tr><td><iframe id="uploadResultFrame" name="uploadResultFrame" onload="onResult()"></iframe></td></tr>
		<tr><td><input type="submit" ></td></tr>
	</table>



</form>
<div id="uploadResultDiv"></div>
</body>
</html>